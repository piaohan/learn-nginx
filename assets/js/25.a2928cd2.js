(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{265:function(n,t,a){"use strict";a.r(t);var s=a(28),e=Object(s.a)({},(function(){var n=this,t=n.$createElement,a=n._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h1",{attrs:{id:"linux-中编译安装和配置-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux-中编译安装和配置-nginx"}},[n._v("#")]),n._v(" Linux 中编译安装和配置 Nginx")]),n._v(" "),a("blockquote",[a("p",[n._v("注意：本示例在 Centos 6.5 、Centos 7.3 中运行。")])]),n._v(" "),a("h2",{attrs:{id:"下载安装包并解压"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载安装包并解压"}},[n._v("#")]),n._v(" 下载安装包并解压")]),n._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 进入约定的安装包目录")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[n._v("cd")]),n._v(" /约定目录/src/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 下载nginx安装文件，这里以 nginx-1.11.1 为例，其他的nginx包可以去官网查找")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("wget")]),n._v(" http://nginx.org/download/nginx-1.11.1.tar.gz\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 把安装包解压，会自动解压到 /约定目/src/nginx-1.11.1/ 文件夹里")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("tar")]),n._v(" xzf nginx-1.11.1.tar.gz\n")])])]),a("h2",{attrs:{id:"nginx的配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx的配置文件"}},[n._v("#")]),n._v(" nginx的配置文件")]),n._v(" "),a("p",[n._v("其实完全可以使用 Nginx 的默认配置文件，默认配置文件编译后的地址在 "),a("code",[n._v("程序目录/conf/nginx.conf")]),n._v(' ，但如果你会频繁的更新 Nginx 版本的话配置文件最后"分离"，类似前后端分离一样，这样可以少"吵架"(解耦合)，我们单独的把 Nginx 的所有配置，包括所有站点的配置、SSL 证书都放在 '),a("code",[n._v("/约定目录/nginx-conf/")]),n._v(" 目录里，如：")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("/约定目录/nginx-conf/\n\n    # nginx配置文件\n    ./nginx.conf\n\n    # nginx的其他配置\n    ./mime.types\n\n    # 站点配置\n    ./conf/\n        # 各个子站点目录\n        ./www.xxoo.com.conf\n        ./www.a.com.conf\n        ...\n")])])]),a("p",[a("code",[n._v("/约定目录/nginx-conf/conf/")]),n._v(" 目录里存放以网站为单位的配置文件，文件名以网站域名命名，这样可以配置分离，互不影响，而且好定位问题。")]),n._v(" "),a("h2",{attrs:{id:"配置nginx安装参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置nginx安装参数"}},[n._v("#")]),n._v(" 配置nginx安装参数")]),n._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 创建对应版本的程序目录，这个目录用来存放编译后的文件")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("mkdir")]),n._v(" -p /约定目录/local/nginx-1.11.1/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 进入安装包解压后的目录")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[n._v("cd")]),n._v(" /约定目录/src/nginx-1.11.1/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 开始配置")]),n._v("\n./configure --prefix"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v("/home/local/nginx-1.11.1 --conf-path"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v("/home/local/nginx-conf/vhost/nginx.conf --with-http_ssl_module --with-http_realip_module --with-http_dav_module --with-http_gzip_static_module --with-http_v2_module\n")])])]),a("p",[n._v("其他的安装编译配置可点击："),a("a",{attrs:{href:"http://www.ttlsa.com/nginx/nginx-configure-descriptions/",target:"_blank",rel:"noopener noreferrer"}},[n._v("Nginx 编译参数"),a("OutboundLink")],1)]),n._v(" "),a("h3",{attrs:{id:"编译nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译nginx"}},[n._v("#")]),n._v(" 编译nginx")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("# 开始编译并安装，可能需要sudo权限\nmake\n[sudo] make install\n")])])]),a("h2",{attrs:{id:"验证是否安装成功"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证是否安装成功"}},[n._v("#")]),n._v(" 验证是否安装成功")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("# 进入nginx执行目录\ncd /约定目录/local/nginx-1.11.1/sbin/\n")])])]),a("p",[n._v("运行 "),a("code",[n._v("./nginx -v")]),n._v(" 查看版本，结果如：")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("nginx version: nginx/1.11.1\n")])])]),a("p",[n._v("如果你有开启 "),a("code",[n._v("http_ssl_module")]),n._v(" ，可运行："),a("code",[n._v("./nginx -V")]),n._v(" 查看是否支持，结果如：")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("nginx version: nginx/1.11.1\nbuilt by gcc 4.4.7 20120313 (Red Hat 4.4.7-16) (GCC)\nbuilt with OpenSSL 1.0.1e-fips 11 Feb 2013\nTLS SNI support enabled\n...\n")])])]),a("h2",{attrs:{id:"重新编译安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重新编译安装"}},[n._v("#")]),n._v(" 重新编译安装")]),n._v(" "),a("p",[n._v("是指已经安装成功, 但想对 Nginx 添加个模块或者修改配置时需要重新编译。")]),n._v(" "),a("h3",{attrs:{id:"_1-下载对应版本-如果不想更新版本可以忽略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载对应版本-如果不想更新版本可以忽略"}},[n._v("#")]),n._v(" 1. 下载对应版本 (如果不想更新版本可以忽略)")]),n._v(" "),a("p",[n._v("可以使用 "),a("code",[n._v("nginx -V")]),n._v(" 查看当前程序的编译参数")]),n._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 下载")]),n._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("wget")]),n._v(" http://nginx.org/download/nginx-1.11.13.tar.gz\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 解压")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("tar")]),n._v(" xzf nginx-1.11.13.tar.gz\n")])])]),a("h3",{attrs:{id:"_2-重新编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-重新编译"}},[n._v("#")]),n._v(" 2. 重新编译")]),n._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 配置")]),n._v("\n./configure --prefix"),a("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v("xxx 你的新参数\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 编译")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("sudo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("make")]),n._v("\n这时侯切记不要make install, 因为make install就会把文件复制到安装目录\n")])])]),a("h3",{attrs:{id:"_3-复制程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-复制程序"}},[n._v("#")]),n._v(" 3. 复制程序")]),n._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 新复制老版本, 以防出错")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("cp")]),n._v(" /path/nginx /path/nginx.back\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 停止服务")]),n._v("\n/path/nginx -s stop\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 复制新版本到安装目录")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("cp")]),n._v(" objs/nginx /path/nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 查看新版本")]),n._v("\n/path/nginx -t\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 启动新版本")]),n._v("\n/path/nginx\n")])])]),a("p",[n._v("注意：如果在运行中直接覆盖 Nginx 会报： "),a("code",[n._v('cp: 无法创建普通文件"nginx": 文本文件忙')]),n._v(" 。")])])}),[],!1,null,null,null);t.default=e.exports}}]);